/* assets/css/style.css */
:root {
    --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    --text-color: #1d1d1f; 
    --text-color-secondary: #6a6a6f; 
    --link-color: #007aff;
    --bg-color: #f0f0f5; 
    --content-bg: #ffffff; 
    --border-color: #d1d1d6; 
    --timeline-dot-color: #d1d1d6; /* Màu dot inactive */
    --timeline-dot-active-color: var(--link-color);
    --timeline-line-color: #e4e6e8; 
    --highlight-paragraph-bg: rgba(0, 122, 255, 0.06); 
    --highlight-sentence-bg: rgba(255, 193, 7, 0.35);
    
    --video-height-normal: 38vh; /* Chiều cao video bình thường */
    --video-height-minimal: 50px; /* Chiều cao video khi tối giản (chỉ controls) */
    --header-height: 90px;    /* Chiều cao của header chứa title và settings */
    --timeline-width: 180px;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body { 
    font-family: var(--font-sans); 
    background-color: var(--bg-color); 
    color: var(--text-color); 
    line-height: 1.65; 
    font-size: 16px; 
    overflow: hidden; /* Ngăn cuộn body, .page-container sẽ xử lý */
}

.page-container { 
    display: flex; 
    flex-direction: column; 
    height: 100vh; 
    /* overflow: hidden; Không cần ở đây nữa nếu content-section cuộn */
}

.video-section { /* Video luôn ở trên cùng */
    width: 100%; 
    height: var(--video-height-normal); 
    background-color: #000; 
    position: sticky; 
    top: 0; 
    z-index: 1001; /* Trên header */
    transition: height 0.3s ease-in-out;
}
body.video-minimal-mode .video-section {
    height: var(--video-height-minimal);
}
/* Tùy chọn: ẩn nội dung iframe khi minimal, chỉ để lại controls (khó thực hiện hoàn hảo với YouTube API) */
/* body.video-minimal-mode #youtube-player-iframe iframe { opacity: 0; pointer-events: none; } */


#youtube-player-iframe { 
    width: 100%; 
    height: 100%; 
    border: none; 
}

.page-header { /* Header nằm dưới video */
    padding: 12px 25px;
    background-color: var(--content-bg);
    border-bottom: 1px solid var(--border-color);
    width: 100%;
    /* max-width: 1440px; /* Bỏ max-width ở đây để nó full-width cùng video */
    /* margin: 0 auto; */
    z-index: 1000;
    position: sticky;
    top: var(--video-height-normal); /* Dính dưới video section */
    transition: top 0.3s ease-in-out;
    height: var(--header-height);
    display: flex;
    flex-direction: column;
    justify-content: center;
}
body.video-minimal-mode .page-header {
    top: var(--video-height-minimal);
}

.video-info h1 {
    font-size: 1.4em; 
    font-weight: 600;
    margin-bottom: 0.1em;
    color: var(--text-color);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.video-info p {
    font-size: 0.8em;
    color: var(--text-color-secondary);
    margin-bottom: 8px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.settings-bar { 
    display: flex; 
    align-items: center; 
    gap: 20px; 
    font-size: .85em; 
}
.settings-bar label { 
    display: flex; 
    align-items: center; 
    cursor: pointer; 
    color: var(--text-color-secondary); 
}
.settings-bar input[type=checkbox] { 
    margin-right: 6px; 
    accent-color: var(--link-color); 
    width:14px; height:14px; 
}

.content-section { /* Container chính cho timeline và transcript, sẽ cuộn */
    display: flex; 
    flex-grow: 1; 
    width: 100%; 
    max-width: 1440px; 
    margin: 0 auto; 
    overflow-y: auto; /* CUỘN CHÍNH Ở ĐÂY */
    /* Chiều cao còn lại sau video và header */
    height: calc(100vh - var(--video-height-normal) - var(--header-height));
    position: relative; /* Để timeline có thể sticky bên trong */
}
body.video-minimal-mode .content-section {
    height: calc(100vh - var(--video-height-minimal) - var(--header-height));
}


#timeline-container { 
    width: var(--timeline-width); 
    flex-shrink: 0; 
    padding: 25px 10px 25px 20px; 
    /* Bỏ overflow-y và height cố định, nó sẽ cuộn cùng .content-section */
    border-right: 1px solid var(--border-color);
    position: sticky; /* Timeline dính lại khi cuộn .content-section */
    top: 0; 
    align-self: flex-start; /* Quan trọng để sticky hoạt động đúng trong flex container */
    height: 100%; /* Chiếm toàn bộ chiều cao của .content-section (vùng cuộn) */
    background-color: #fdfdfe; /* Màu nền nhạt hơn cho timeline */
}

.timeline-list { 
    list-style: none; 
    padding: 0; 
    margin:0; 
    position: relative; 
}

/* Đường kẻ dọc chính của timeline, chạy qua tâm các dot */
.timeline-list::before {
    content: '';
    position: absolute;
    /* (timestamp width 65px) + (padding-right of timestamp 15px) + (half of dot-container's effective left space 15px) - (half of line width 1.5px) */
    left: calc(65px + 15px + ( (var(--timeline-width) - 65px - 25px - 15px - 12px) / 2 ) + 15px - 1.5px); 
    /* Tạm thời tính toán đơn giản hơn, căn vào giữa timeline-dot-container */
    left: calc(65px + 15px + ( (var(--timeline-width) - 65px - 25px - 15px ) / 2 ) - 1.5px ); /* Khoảng 90px */

    top: 12px; /* Để bắt đầu từ dot đầu tiên */
    bottom: 12px; /* Kết thúc ở dot cuối cùng */
    width: 2.5px; /* Đường kẻ đậm hơn chút */
    background-color: var(--timeline-line-color);
    border-radius: 2px;
    z-index: 0; /* Nằm dưới dot */
}


.timeline-item { 
    position: relative; 
    display: flex; 
    align-items: center; 
    min-height: 30px; /* Chiều cao tối thiểu cho mỗi item */
    padding: 5px 0; /* Giảm padding dọc để timeline đỡ thưa */
    cursor: pointer; 
    border-radius: 6px; 
    margin-right: 5px;
    transition: background-color .15s ease; 
}
.timeline-item:hover { background-color: rgba(0,0,0,.03); }

.timeline-timestamp { 
    font-size: .75em; 
    color: var(--text-color-secondary); 
    width: 65px; 
    text-align: right; 
    padding-right: 15px; 
    font-variant-numeric: tabular-nums; 
    z-index: 1;
    transition: color 0.2s ease, font-weight 0.2s ease;
}

.timeline-dot-container { 
    /* Căn chỉnh dot lên đường kẻ dọc */
    width: calc(var(--timeline-width) - 65px - 25px); /* timeline_width - timestamp_width - timeline_container_padding_left */
    display:flex; 
    justify-content: flex-start; /* Dot sẽ nằm ở đầu container này */
    padding-left: calc(15px + ( ( (var(--timeline-width) - 65px - 25px - 15px ) / 2 ) - 1.5px ) - (12px/2)  ); /* Tính toán để dot nằm trên đường kẻ */
    /* Đơn giản hóa: */
    padding-left: calc( (var(--timeline-width) - 65px - 25px - 12px) / 2 ); /* Căn dot vào giữa không gian còn lại */


    z-index: 1;
}

.timeline-dot { 
    width: 10px; 
    height: 10px; 
    background-color: var(--content-bg); 
    border-radius: 50%; 
    border: 2px solid var(--timeline-dot-color); 
    transition: all .2s ease-in-out; 
    flex-shrink:0;
    opacity: 0.7; /* Dot inactive mờ hơn */
}

.timeline-item.active .timeline-dot { 
    border-color: var(--timeline-dot-active-color); 
    background-color: var(--timeline-dot-active-color); 
    transform: scale(1.35); 
    opacity: 1;
    box-shadow: 0 0 8px rgba(0,122,255,0.5);
}

.timeline-item.active .timeline-timestamp { 
    color: var(--timeline-dot-active-color); 
    font-weight: 600; 
}
        
#transcript-content-container { 
    flex-grow: 1; 
    padding: 25px; 
    /* Bỏ overflow-y và height cố định, nó sẽ cuộn cùng .content-section */
}

.transcript-paragraph-text { margin-bottom: 1.8em; padding: 10px 12px; border-radius: 8px; font-size: 1rem; line-height:1.65; letter-spacing: -0.01em; }
.transcript-paragraph-text.highlighted-paragraph { background-color: var(--highlight-paragraph-bg); }
.transcript-sentence { cursor: pointer; padding: 0.5px 2px; margin-right: 2px; border-radius: 3px; transition: background-color .15s ease-in-out, box-shadow 0.15s ease-in-out; }
.transcript-sentence:hover { background-color: rgba(0,0,0,.04); }
.transcript-sentence.highlighted-sentence { background-color: var(--highlight-sentence-bg); }
.no-transcript-message { padding: 20px; text-align: center; color: var(--text-color-secondary); }

/* Responsive adjustments */
@media (max-width:900px) { 
    :root { --timeline-width: 120px; /* Giảm chiều rộng timeline cho màn hình nhỏ hơn */ }
    .content-section { 
        /* Không cuộn riêng nữa, page-container sẽ cuộn */
        /* overflow-y: auto; */ 
        /* height: calc(100vh - var(--video-height-normal) - var(--header-height)); */
    }
    #timeline-container {
        /* Timeline sẽ không sticky theo kiểu cũ nữa khi .content-section cuộn */
        /* position: static; */
        /* height: auto; */
        /* overflow-y: visible; */
        padding: 20px 15px 20px 15px;
    }
    body { overflow-y: auto; } /* Cho phép body cuộn trên mobile nếu content dài */
    .page-container { height: auto; }
    .content-section { overflow-y: visible; height: auto; max-width: 100%; padding: 0 15px; }

     /* Có thể ẩn timeline hoàn toàn trên màn hình rất nhỏ, hoặc làm nó ngang */
    #timeline-container { display: none; } /* Đơn giản nhất là ẩn đi */
    #transcript-content-container { padding: 20px 15px; }

}
@media (max-width:600px) { 
    :root { --video-height-normal: 30vh; --header-height: 80px;}
    body.video-minimal-mode .video-section { height: var(--video-height-minimal); }
    .content-section { font-size:.9rem; }
    .transcript-paragraph-text { font-size: 0.95rem; }
    .video-info h1 { font-size: 1.2em; }
    .video-info p { font-size: 0.75em; }
    .settings-bar { font-size: 0.8em; }
}
